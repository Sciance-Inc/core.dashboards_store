# Absences des employé(e)s

> [!NOTE]
> Suivre les absences des employés dans les différents lieux de travail sur une période sélectionnée. Le tableau de bord affiche les taux d’absentéisme, les tendances hebdomadaires et les totaux par catégorie, avec des filtres pour la plage de dates, le type d’emploi, le lieu de travail, et plus encore.

## Déploiement
![tag:emp_abs](https://img.shields.io/badge/tag-emp_abs-brightgreen)
![new in v.019.0](https://img.shields.io/badge/new-v0.18.0%2B20250611-yellow)


## Bases de données
La base de données `paie` doit être liée au projet. Veuillez vous référer à la section [Lier une base de données](/using/configuration/databases) pour plus d'informations sur la façon de lier une base de données.

## Magasins de données (marts)

Les magasins de données (marts) suivants doivent être activés pour que le tableau de bord fonctionne. Veuillez vous référer à la section [enabling a mart](/using/configuration/enabling) pour plus d’informations sur la manière d’activer un magasin de données.
- `human_resources`

## Seed

Le tableau de bord nécessite les 4 seeds suivantes : `ens_qualification`, `statut_enseignant`, `secteur` et `heure_quotidienne`. Veuillez consulter la section sur l'amorçage [seeding](/using/configuration/adapts-seeds) pour plus d'informations sur l'amorçage d'un mart. Ces seeds sont nécessaires pour peupler les sujets sanctionnées. Comme vous n'aurez pas besoin de les remplacer, vous pouvez simplement exécuter la commande suivante pour créer la seed :  
`dbt seed --select +tag:emp_abs`  

 ### etat_empl
  **Endroit de la seed :** `seeds/marts/human_resources/schema.yml`
   **Champs obligatoires :**
   1. `etat_empl` : Code unique de la qualification  
   2. `descr` : Description du code de qualification  
   3. `etat_actif` : Indique si l’employé est actif  
   4. `empl_retr` : Indique si l’employé est retraité  
   5. `empl_cong` : Indique si l’employé est en congé  
   6. `cong_lt` : Indique si l’employé est en congé de longue durée
   7. `type_duration` : Type de durée : 0 = Courte durée, 1 = Longue durée
   **Nouveaux champs :**
   1. `type_duration` : Type de durée : 0 = Courte durée, 1 = Longue durée
---
 ### type_absence
  **Endroit de la seed :** `seeds/marts/human_resources/schema.yml`
   **Champs obligatoires :**
   1. `motif_id` : Identifiant unique du motif d’absence  
   2. `statut` : Statut du motif : 0 = actif, 1 = inactif  
---
 ### secteur
 [!NOTE] Cette seed est fournie à titre optionnel. Si votre CSS ne contient pas de secteurs, il n’est pas nécessaire de l’inclure dans votre projet.
  **Endroit de la seed :** `seeds/dashboards/human_resources/schema.yml`
   **Champs non obligatoires :**
   1. `lieu_trav` : Le numéro de l'unité administrative ou de l'école
   2. `secteur_Id` : L'ID du secteur géographique ou subdivition de votre territoire
   3. `secteur_Descr` : Description du secteur géographique ou subdivition de votre territoire
---
 ### heure_quotidienne
 **Endroit de la seed :** `seeds/dashboards/human_resources/schema.yml`
   **Champs obligatoires :**
   1. `categorieEmp` : Catégorie d'emploi. ex - 1 = Cadre, 2 = professionnel etc
   2. `poste_specifique` : Indique si le poste est spécifique (1) ou non (0)
   3. `corp_empl` : Code du corps d'emploi (4 caractères)   
   4. `heure` : Nombre d'heures quotidiennes associées   

## Spécification du projet dbt
### Configuration requise
1. Mettez à jour votre fichier  `cssXX.dashboards_store/dbt_project.yml` avec l'extrait de code suivant :
```yaml
# cssXX.dashboards_store/dbt_project.yml
models:
  core_dashboards_store:
    marts:
      human_resources:
        +enabled: True
    dashboards:
      human_resources:
        emp_abs:
          +enabled: true
    interfaces:
      paie:
        +enabled: true
```

### Définition de la variable code_paiement 
La variable code_paiement est requise pour que les absences ayant ce code de paiement ne soient pas prises en compte. Cette variable DOIT être définie pour que le tableau de bord fonctionne correctement. ::
```yaml
#cssXX.data.dbe/dbt_project.yml
vars:
  dashboards:
    emp_abs:
      code_paiement: ###% -- E.g. '[103525]'
```

## Spécification du projet tableau de bord
### Table Calendrier
Il faut impérativement ajouter et supprimer les mesures ayant le préfix "JT_" selon les groupes de paie de votre CSS.
Ces mesure sont requises pour calculer le taux d'absentéisme et représentent le nombre de jours travailler.

Exemple : 
```yaml
JT_E0 = CALCULATE([JT_Core], 'ParamPaie'[gr_paie] = "E0")
```
### Table Absence
Même principe pour la table Absence, il faut ajuster les mesures ayant comme préfix "Abs_" en fonction des groupes de paie de votre CSS. 
Ces mesures sont nécessaires pour calculer le taux d'absentéisme et représentent le nombre d'employé(e)s.

Exemple : 
```yaml
Abs_eo = 
CALCULATE(
    DISTINCTCOUNT('Absences'[matricule]),
    'Absences'[gr_paie] = "E0"
)
```
